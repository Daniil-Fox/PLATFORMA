# Настройка автоматической загрузки видео из VK сообщества

## Шаг 1: Получение VK API токена

1. Перейдите на https://vk.com/dev
2. Создайте Standalone-приложение
3. Получите `access_token` с правами доступа к видеозаписям сообщества

## Шаг 2: Настройка PHP скрипта

Отредактируйте файл `src/resources/vk-videos.php`:

```php
$config = [
    'access_token' => 'YOUR_VK_ACCESS_TOKEN', // Замените на ваш токен
    'owner_id' => '-YOUR_GROUP_ID', // Отрицательный ID сообщества
    'count' => 10, // Количество видео для получения
    'api_version' => '5.131'
];
```

### Как получить ID сообщества:
- Откройте ваше сообщество VK
- В адресной строке найдите ID (например: vk.com/club123456789)
- Добавьте знак минус перед ID: `-123456789`

## Шаг 3: Настройка автоматического обновления

### Вариант 1: Cron задача (рекомендуется)
Добавьте в crontab:
```bash
# Обновление каждые 30 минут
*/30 * * * * /usr/bin/php /path/to/your/site/src/resources/vk-videos.php
```

### Вариант 2: JavaScript автообновление
Компонент автоматически обновляется каждые 5 минут (настраивается в `vk-videos.js`).

## Шаг 4: Настройка веб-сервера

Убедитесь, что PHP скрипт доступен по URL `/vk-videos.php` или измените путь в JavaScript:

```javascript
// В файле vk-videos.js
window.vkVideosLoader = new VKVideosLoader(moreSlider, {
    apiUrl: '/vk-videos.php', // Измените на нужный путь
    autoUpdate: true,
    maxVideos: 5
});
```

## Шаг 5: Проверка работы

1. Загрузите новое видео в VK сообщество
2. Подождите до следующего обновления (до 30 минут)
3. Проверьте, что видео появилось в слайдере на сайте

## Дополнительные настройки

### Изменение количества видео:
```php
'count' => 15, // В vk-videos.php
```

### Изменение интервала обновления:
```javascript
updateInterval: 10 * 60 * 1000, // 10 минут в vk-videos.js
```

### Отключение автообновления:
```javascript
autoUpdate: false, // В vk-videos.js
```

## Структура файлов

```
src/
├── resources/
│   ├── vk-videos.php          # PHP скрипт для API
│   ├── vk-videos-cache.json   # Кэш видео (создается автоматически)
│   └── VK_VIDEOS_SETUP.md     # Эта инструкция
├── js/
│   └── components/
│       └── vk-videos.js       # JavaScript компонент
└── scss/
    └── components/
        └── _vk-videos.scss    # Стили для компонента
```

## Возможные проблемы

### Ошибка "VK API Error"
- Проверьте правильность `access_token`
- Убедитесь, что токен имеет права на доступ к видео сообщества

### Видео не загружаются
- Проверьте, что в сообществе есть публичные видео
- Убедитесь, что `owner_id` указан правильно (с минусом)

### Кэш не обновляется
- Удалите файл `vk-videos-cache.json`
- Проверьте права на запись в папку

## Безопасность

- Не публикуйте `access_token` в открытом доступе
- Используйте HTTPS для передачи данных
- Ограничьте доступ к PHP скрипту через .htaccess при необходимости

## Поддержка

При возникновении проблем проверьте:
1. Логи веб-сервера
2. Консоль браузера (F12)
3. Содержимое файла кэша
